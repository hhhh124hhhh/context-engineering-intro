# 🎮 游戏设计文档

## 📋 概述

**游戏名称**: 卡牌对战竞技场
**游戏类型**: 回合制卡牌对战游戏
**目标平台**: Web浏览器
**核心玩法**: 玩家使用卡牌击败对手

## 🎯 核心设计原则

### 简单易学
- 规则简单直观
- 界面清晰易用
- 新手友好

### 策略深度
- 卡牌组合策略
- 资源管理
- 风险与回报

### 公平竞技
- 运气因素适中
- 技能决定胜负
- 平衡性调整

## 🎮 游戏机制

### 基础规则

#### 游戏准备
1. **英雄选择**: 每个玩家选择一个英雄
2. **卡组构建**: 30张卡的卡组
3. **起始手牌**: 随机抽取3张起始手牌
4. **先手确定**: 随机决定先手玩家

#### 回合流程
```
每回合流程:
1. 回合开始阶段
   - 法力值上限 +1 (最大10)
   - 当前法力值回满
   - 抽1张牌

2. 抽牌阶段
   - 从牌库抽1张牌到手牌
   - 检查牌库是否为空

3. 主要阶段
   - 打出卡牌 (消耗法力值)
   - 使用英雄技能 (消耗2点法力)
   - 随从攻击
   - 英雄攻击

4. 结束阶段
   - 回合结束效果触发
   - 手牌数量检查 (超过7张弃牌)
   - 切换到对手回合
```

#### 胜负条件
- **胜利条件**: 将对手英雄生命值降至0或以下
- **失败条件**: 自己英雄生命值降至0或以下

### 卡牌系统

#### 卡牌类型

##### 随从卡 (Minion)
```
属性:
- 攻击力 (Attack): 1-12
- 生命值 (Health): 1-12
- 法力值消耗 (Cost): 1-10
- 卡牌类型 (Type): 随从
- 稀有度 (Rarity): 普通/稀有/史诗/传说
- 关键词 (Keywords): 战吼/亡语/圣盾等

效果:
- 战吼 (Battlecry): 打出时触发效果
- 亡语 (Deathrattle): 死亡时触发效果
- 圣盾 (Divine Shield): 免疫第一次伤害
- 嘲讽 (Taunt): 必须先攻击随从
- 冲锋 (Charge): 可以立即攻击
- 风怒 (Windfury): 每回合可攻击两次
```

##### 法术卡 (Spell)
```
属性:
- 法力值消耗 (Cost): 0-10
- 卡牌类型 (Type): 法术
- 稀有度 (Rarity): 普通/稀有/史诗/传说
- 效果类型 (Effect Type): 立即/持续/延迟

效果分类:
- 直接伤害: 对目标造成伤害
- 治疗: 恢复目标生命值
- 抽牌: 从牌库抽牌
- 控制效果: 冻结、沉默、变形等
- 强化效果: 增加攻击力/生命值
```

##### 武器卡 (Weapon)
```
属性:
- 攻击力 (Attack): 1-5
- 耐久度 (Durability): 1-3
- 法力值消耗 (Cost): 1-5
- 卡牌类型 (Type): 武器
- 稀有度 (Rarity): 普通/稀有/史诗

效果:
- 英雄获得攻击力
- 每次攻击消耗1点耐久度
- 耐久度为0时武器破坏
```

##### 英雄技能 (Hero Power)
```
属性:
- 法力值消耗 (Cost): 2
- 使用次数: 每回合一次
- 效果类型: 各英雄独特效果

示例效果:
- 法师: 造成1点伤害
- 战士: 获得2点护甲
- 牧师: 恢复2点生命值
```

#### 关键词效果

##### 战斗关键词
- **冲锋 (Charge)**: 打出回合可以立即攻击
- **嘲讽 (Taunt)**: 敌方随从必须先攻击嘲讽目标
- **圣盾 (Divine Shield)**: 免疫下一次伤害
- **风怒 (Windfury)**: 每回合可以攻击两次
- **潜行 (Stealth)**: 无法成为攻击或法术目标

##### 触发关键词
- **战吼 (Battlecry)**: 打出时触发效果
- **亡语 (Deathrattle)**: 从战场移除时触发效果
- **激励 (Inspire)**: 使用英雄技能时触发效果

### 游戏状态

#### 玩家状态
```python
class PlayerState:
    hero: Hero                    # 英雄信息
    health: int                   # 英雄生命值 (30)
    armor: int                    # 护甲值
    mana: int                     # 当前法力值
    max_mana: int                 # 法力值上限
    hand: List[Card]              # 手牌 (上限7张)
    deck: List[Card]              # 牌库
    battlefield: List[Minion]      # 战场随从
    secrets: List[Secret]         # 奥秘
    used_hero_power: bool         # 本回合是否使用过英雄技能
```

#### 游戏状态
```python
class GameState:
    player1: PlayerState          # 玩家1状态
    player2: PlayerState          # 玩家2状态
    current_player: int           # 当前玩家 (1或2)
    turn_number: int              # 回合数
    phase: TurnPhase              # 当前阶段
    game_over: bool               # 游戏是否结束
    winner: Optional[int]         # 胜利玩家
    history: List[GameAction]     # 游戏历史
```

### AI对手设计

#### AI难度等级
1. **简单 (Easy)**
   - 随机出牌
   - 基础攻击逻辑
   - 不考虑策略

2. **普通 (Normal)**
   - 按法力值曲线出牌
   - 基本威胁评估
   - 简单的配合

3. **困难 (Hard)**
   - 策略性出牌
   - 威胁评估和优先级
   - 预测对手行动

#### AI决策逻辑
```python
class AIDecision:
    def evaluate_move(self, game_state, possible_moves):
        """评估可能的移动"""
        scores = []
        for move in possible_moves:
            score = self.calculate_score(move, game_state)
            scores.append((move, score))

        # 根据难度选择移动
        if self.difficulty == "easy":
            return random.choice(possible_moves)
        elif self.difficulty == "normal":
            return self.select_top_moves(scores, top_k=3)
        else:  # hard
            return max(scores, key=lambda x: x[1])[0]
```

## 🎨 界面设计

### 布局结构
```
┌─────────────────────────────────────────┐
│              对手信息区域                 │
│  英雄 | 生命值 | 法力值 | 手牌数量          │
├─────────────────────────────────────────┤
│              对手战场区域                 │
│        [随从] [随从] [随从] [随从]        │
├─────────────────────────────────────────┤
│              游戏日志区域                 │
│  "玩家打出了火焰冲击"                    │
├─────────────────────────────────────────┤
│              玩家战场区域                 │
│        [随从] [随从] [随从] [随从]        │
├─────────────────────────────────────────┤
│              玩家手牌区域                 │
│  [卡牌] [卡牌] [卡牌] [卡牌] [卡牌]      │
├─────────────────────────────────────────┤
│              玩家信息区域                 │
│  英雄 | 生命值 | 法力值 | 结束回合按钮     │
└─────────────────────────────────────────┘
```

### 交互设计
- **卡牌拖拽**: 拖拽卡牌到目标位置
- **点击选择**: 点击目标进行攻击或使用法术
- **悬停提示**: 显示卡牌详细信息
- **动画效果**: 卡牌移动、攻击、伤害动画

## 📊 平衡性设计

### 法力值曲线
- 1费卡: 15-20%
- 2费卡: 20-25%
- 3费卡: 20-25%
- 4费卡: 15-20%
- 5费以上卡: 10-15%

### 卡牌效果平衡
- **直接伤害**: 1费 = 1点伤害
- **治疗**: 1费 = 2点治疗
- **抽牌**: 1费 = 1张牌
- **随从**: 攻击力 + 生命值 ≈ 法力值 × 2

### 胜率目标
- **先手优势**: 48-52%胜率
- **卡组内平衡**: 各职业间差距 < 5%
- **AI难度**: 简单30% / 普通50% / 困难70%胜率

## 🔧 技术实现

### 游戏引擎架构
```
GameEngine
├── GameState (游戏状态管理)
├── ActionValidator (动作验证)
├── EffectProcessor (效果处理)
├── AIPlayer (AI对手)
└── GameRules (游戏规则)
```

### 状态同步机制
- **本地游戏**: 内存状态管理
- **持久化**: SQLite数据库
- **回放功能**: 动作历史记录

### 性能优化
- **状态计算优化**: 增量更新
- **AI决策缓存**: 常见局面缓存
- **界面渲染优化**: 虚拟化长列表

## 🧪 测试策略

### 游戏逻辑测试
- **规则验证**: 确保所有规则正确实现
- **边界条件**: 测试极端情况
- **AI行为**: 验证AI决策逻辑
- **平衡性测试**: 模拟大量游戏对局

### 性能测试
- **响应时间**: 每个动作 < 100ms
- **内存使用**: 游戏状态 < 1MB
- **AI思考时间**: 每回合 < 3秒

### 用户体验测试
- **易用性测试**: 新手玩家体验
- **界面响应**: 交互流畅性
- **错误处理**: 异常情况处理

## 📈 扩展计划

### V1.1 功能
- 更多卡牌效果
- 成就系统
- 统计数据

### V1.2 功能
- 多人对战
- 排行榜系统
- 卡牌收集

### V2.0 功能
- 锦标赛模式
- 观战功能
- 移动端适配

---

**🎮 这个设计确保了游戏的核心玩法简单有趣，同时具有足够的策略深度。**